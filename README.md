 # Πλαίσιο προσομοίωσης χρονοπρογραμματισμού εργασιών κέντρου δεδομένων CloudSimPy

Το σύστημα δρομολογητή, που αρχικά ανέπτυξε ο FC Li και εξέλιξα εγώ, βασίζεται στο πλαίσιο προσομοίωσης διακριτών γεγονότων [SimPy](https://simpy.readthedocs.io/en/latest/contents.html) και υλοποιείται με τη χρήση της γλώσσας *Python*,
Το σύστημα μας, μπορεί να ενσωματωθεί καλά με πλαίσια βαθιάς μάθησης (π.χ. *TensorFlow*, *Torch*) που έχουν υποστήριξη της γλώσσας *Python*, γεγονός που μπορεί να βοηθήσει στη μελέτη της μηχανικής μάθησης ή της διαχείρισης πόρων με βάση τη βαθιά μάθηση.

Ο αλγόριθμος χρονοπρογραμματισμού εργασιών του κέντρου δεδομένων που βασίζεται στη βαθιά ενισχυτική μάθηση στο `CloudSimPy/playground/DAG/algorithm/DeepJS/DQLAgent.py` & `../DQLScheduler.py` υλοποιούνται με τη χρήση της βιβλιοθήκης *torch*.

## CloudSimPy
Ως πλαίσιο προσομοίωσης χρονοπρογραμματισμού εργασιών κέντρου δεδομένων, το *CloudSimPy* περιέχει δύο πακέτα *Python* `core` και `playground`.
#### Core
Το πακέτο `core` αφηρημένο και μοντελοποιεί τις οντότητες (*entity*) σε ένα πρόβλημα χρονοπρογραμματισμού εργασιών ενός κέντρου δεδομένων, το πακέτο `core` περιέχει τις ακόλουθες ενότητες:

+ Τα `TaskInstanceConfig`, `TaskConfig`, `JobConfig` στο `config` δίνουν τη διαμόρφωση (απαιτήσεις πόρων, διάρκεια κ.λπ.) των περιπτώσεων εργασιών, των εργασιών και των θέσεων εργασίας, αντίστοιχα.
+ `job` όπου `TaskInstance`, `Task`, `Job` αποτελούν τη δομή της μοντελοποίησης των περιπτώσεων εργασιών.
+ `machine` μοντελοποιεί τη μηχανή.
+ Το `node` μοντελοποιεί μια υπολογιστική συστάδα που αποτελείται από τρία μηχανήματα.
+ Το `cluster` μοντελοποιεί μια υπολογιστική συστάδα, η κλάση `Cluster` διατηρεί έναν κατάλογο των κόμβων πυ περιέχει.
+ `αλγόριθμος` ορίζει τη διεπαφή με τον αλγόριθμο χρονοπρογραμματισμού, ο οποίος πρέπει να υλοποιείται από αλγόριθμους χρονοπρογραμματισμού που ορίζονται από τον χρήστη, και είναι το κλειδί για την υλοποίηση του μοντέλου.
+ `scheduler` μοντελοποιεί τον χρονοπρογραμματιστή, ένα πρότυπο σχεδίασης που επιτρέπει σε διαφορετικές περιπτώσεις του `Scheduler` να προγραμματίζονται με διαφορετικούς αλγορίθμους χρονοπρογραμματισμού.
+ `broker` υλοποιεί την κλάση `Broker`, η οποία υποβάλλει εργασίες στη συστάδα υπολογιστών για λογαριασμό του χρήστη.
+ `monitor` υλοποιεί την κλάση `Monitor`, η οποία χρησιμοποιείται για την παρακολούθηση και την καταγραφή της κατάστασης μιας προσομοίωσης κατά τη διάρκεια της διαδικασίας προσομοίωσης.
+ Η `simulation` μοντελοποιεί μια προσομοίωση, η οποία πρέπει να κατασκευάσει μια περίπτωση συστάδας `Cluster`, να κατασκευάσει μια σειρά από περιπτώσεις διαμόρφωσης εργασιών `JobConfig` και να χρησιμοποιήσει αυτές τις περιπτώσεις διαμόρφωσης εργασιών για να κατασκευάσει μια περίπτωση `Broker`, να κατασκευάσει μια περίπτωση χρονοπρογραμματιστή `Scheduler`.

#### Playground
Το πακέτο `playground` έχει σχεδιαστεί για να διευκολύνει τον πειραματισμό από τους χρήστες του πακέτου και αποτελείται από το πακέτο `DAG`.
To auxiliary' περιέχει μεθόδους και συναρτήσεις που έχουν βοηθητικό ρόλο στην ανάπτυξη του συστήματος του δρομολογητή και του μοντέλου ενισχυτικής μάθησης.
+ Εντός του φακέλου έχουμε δημιουργήσει ένα script *run_agent.py* μέσω του οποίου μπορούμ ενα τρέξουμε πολλαπλά επεισόδια που έχουμ αποθηκευετί για τη γρήγορη εκπαίδευση του μοντέλου μας
Το `DAG` είναι προ-υλοποιημένo με ορισμένους ευρετικούς αλγορίθμους χρονοπρογραμματισμού εργασιών καθώς και με αλγορίθμους χρονοπρογραμματισμού εργασιών που βασίζονται σε βαθιά ενισχυτική μάθηση, αντίστοιχα.
Όσον αφορά το DRL μοντέλο υπάρχουν οι εξής μέθοδοι:
+ Η κλάση του πράκτορα, η οποία υλοποιεί την *βαθμίδα πολιτικής* στην ενισχυτική μάθηση
+ Ο εγκέφαλος *torch* που υλοποιεί τη δομή του νευρωνικού δικτύου
+ Η κλάση του δρομολογητή, η οποία υλοποιεί την ενημέρωση των καταστάσεων του συστήματος, των ενεργειών καθώς και την αποθήκευση των τούπλων που λαμβάνει από το σύστημα στον buffer του μοντέλου.
+ Η μέθοδος της συνάρτησης κέρδους, στην οποία περιγράφονται όλες οι εσωτερικές διαδικασίες της επιβράβευσης του μοντέλου
+ Ένα φάκελο agent, στον οποίο αποθηκεύονται τα μοντέλα με τα βάρη τους, όπως λαμβάνονται μετά την εκπαίδευσή τους.
+ Ένα φάκελο episodes, στον οποίο έχουν αποθηκευετεί κατηγοριοποιημένα πολλά εκτελεσμένα επεισόδια για την ταχύτερη εκμετάλλευσή τους
+ Ένα φάκελο jobs_files, εντός του οποίο υπάρχουν τα δεδομένα των εργασιών που λάβαμε από το dataset της Alibaba καθώς και scripts για την επεξεργασία τους.
+ Ένα φάκελο launch_scripts, εντός το οποίου υπάρχει το αρχείο *main-single-process.py* που αποτελεί τον τρόπο που τρέχουμε το πρόγραμμά μας δίνοντας του ως παραμέτρους τους εξής:
+ + 1η παράμετρος: Σε περίπτωση που θέλουμε να τρέξουμε κάποιον αλγόριθμο δρομολόγησης εργασιών χωρις το μοντέλο ενισχυτικής μάθησης χρησιμοποιούμε το *0* αλλιώς το *1*.
  + 2η παράμετρος: Ορίζουμε *First Fit* ή *Best Fit* αναλόγως με τον αλγόριθμο που θέλουμε να χρησιμοποιήσουμε ως βλαση του δρομολογητή μας.
  + 1η παράμετρος: Ορίζουμε το όνομα του μοντέλου μας
  + 1η παράμετρος: Ορίζουμε το learning rate
  + 1η παράμετρος: Ορίζουμε τον αριθμό των επιπέδων (έχει προ-κατασκευασμένα μοντέλα, οι επιλογές μας είναι μεταξύ *5*,*6*,*7*)
  + 1η παράμετρος: Ορίζουμε συνάρτηση ενεργοποίησης των επιπέδων του δικτύου μεταξύ *ReLU* και *LeakyReLU*
  + 1η παράμετρος: Ορίζουμε συνάρτηση σφάλματος μεταξύ *MSE* και *Huber*

Επιπρόσθετα, μπορούμε να χρησιμοποίησουμε το script run_subprocesses.py* που βρίσκεται εντός του φακέλου launch_scripts για την αυτοματοποιήση της εκτέλεσης των επεισοδίων.
